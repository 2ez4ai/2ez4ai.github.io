---
layout: post
categories: unity3d
comments: True
title: Unity3D - Adventure of Elements
published: True
description: A combination of Match3 and Rogue Like.
---

{% include youtubePlayer.html id="Fsvt9NTzlRM" %}
<center>
  <p style="font-size:80%;">
Video 1. Demo video.
  </p>
</center>
# 1. Introduction

This is my final project of the unity course given by [Mr. Brian](http://www.briancox.be/). It is a casual game trying to combine **Match3** with **Rogue Like**. All the source code and installers for Windows/Mac/Android are available [here](http://github.com/2ez4ai/AdventureOfElements). An online version is also available [now](https://play.unity.com/mg/other/webgl-builds-66949).

There are two characters in each battle: a player representing you, and a creature generated by the game. The tiles are of five types: Jin (Metal), Mu (Wood), Shui (Water), Huo (Fire), and Tu (Earth). Every time you make a valid swap, which means the swap leads to a match, those matched tiles will be removed and other tiles will fall to fill in the empty position, which may cause another round of matching. The creature will take damage from the removed tiles, and it will launch attack like every 3 or 4 swaps. The damage the creature would cause to you depends on the number of tiles of a certain type. For example, if the attack of the creature is of fire type, then the damage will depend on the fire tiles on the board.

For rogue like elements, apart from the innate randomness of Match3, I made up some skills as rewards every time you win a battle. Based the rules of Match3, it is very easy to come up with appealing skills, like allowing diagonally swap, adding extra effect when a tile is removed, *etc*.  Also, since there is a battle system related to HP, I also made up skills that are very common in traditional rogue like games like increasing maximum HP.

There is no final level in this game. You can go as far as you can. But as the time for this project is limited, the creatures I made vary mainly in numerical settings, like HP values, and attack frequency.

# 2. Motivation

For me, there are two reasons why doing such a leisure game. The first one is about something like completeness and self-consistency. Before the second project, we learned how to make use of the animation and model resources. However, I found it is very tricky when it comes to finding a desired scene model. I mean, you need to be careful of model clips, and a good story line is necessary for guiding the move around the scene. So instead of using those fancy models but being poor in completeness, I decided to make a leisure game with only simple object, and then match3 occurred to me very naturally.

The second one is about novelty, and that is why I bring in rogue like. Can you name one game with Match3 and rogue like? I guess no, even though you can find a bunch of them in Google. It seems there is still no one of this type has achieved a phenomenal success. Therefore, instead of replacing the story line of traditional games without changing the core part, I want to give a try to this combination of great potential.

# 3. Implementation

All the project files are available in my repository, and you can find out that there is nothing new or special. For me, the only tricky thing is in the board logic, especially in the tile falling part.

Consider a board of $8\times 8$ size, which means there will be 64 tiles on the board. All the tiles are stored in an array. During almost the whole development, I use `GetComponents<Tiles>` to get those tiles. Since I have arranged the order of tiles well in the editor, it works for me, *i.e.* the tile of index 0 is the one on the bottom left of the board, and the one on its right side is of index 1, *etc*. However, it fails to work in the build! That is so weird and I had to redo it by using `instantiate` with specifying the position.

The swap and selection is easy to be implemented once the array is available. But for falling, it tortures me a lot. Apparently, every time you get a match, it should generate new tiles with the number equalling to that of tiles you removed, and all the tiles above the removed tiles should fall after the removing. However, I think generating new tiles entails modifying the array itself, which may be hard to maintain. So instead of generating new tiles, all the tiles I use during the game are the ones generated at the very beginning of the game. What I do is changing their position and material to make it looks like some tiles do vanish and some tiles do emerge.

For other features, I listed some in the following part for reference.

- `Avatar Masking, IK animation, NavMeshAgent, Rigidbody`: main menu scene animation;
- `PostProcessing`: main menu scene animation, removing effect;
- `PlayerPrefs`: main menu load button, auto save;
- `BlenderTree`: player avatar, player reaction;
- `TailRenderer`: attack effect, skill effect;
- `XML`: localisation;
- `OnPointerEnter`: UI, interaction.

# 4. Future Work

There are many things can be improved, and among them I think there are two of most importance. The first one is about the arts. To achieve self-consistency, I made all the textures with PowerPoint. However, as you can see the game scene is too plain. The second one is about the skills, for a rogue like game, a point is that there are many interesting and optional buildings of skills, like that of Hades, Slay the Spire. But in this game there is no such freedom given the tiny amounts of skills.